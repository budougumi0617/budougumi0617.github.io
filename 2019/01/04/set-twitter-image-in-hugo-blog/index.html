<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  
    
    
      <link href="/css/fonts.css" rel="stylesheet" type="text/css">
    
  

  
  <title>Hugoのブログ記事にTwitter Card(アイキャッチ画像)を設定する</title>

  
  
  <link rel="stylesheet" href="/css/hugo-octopress.css">

  
  

  
    <link rel="stylesheet" href="/css/fork-awesome.min.css">
  

  
  <link href="https://budougumi0617.github.io/favicon.png" rel="icon">

  
  
  

  

  <meta name="description" content="">
  <meta name="keywords" content="hugo,Twitter Card,blog,SEO">

  <meta name="author" content="">

  
  <meta name="generator" content="Hugo 0.50" />

  
  

  
  
    

  
  
    <meta property="og:image" content="https://budougumi0617.github.io/logos/hugo-logo.png"/>
  
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image:src" content="https://budougumi0617.github.io/logos/hugo-logo.png"/>
  
  
  <meta property="og:url" content="https://budougumi0617.github.io/2019/01/04/set-twitter-image-in-hugo-blog/"/>
  <meta property="og:type" content="article"/>
  <meta property="og:title" content="Hugoのブログ記事にTwitter Card(アイキャッチ画像)を設定する"/>
  <meta property="og:description" content="HugoでTwitter Card（アイキャッチ画像）を設定したときのメモ。



"/>
  
  <meta name="twitter:title" content="Hugoのブログ記事にTwitter Card(アイキャッチ画像)を設定する"/>
  <meta name="twitter:description" content="HugoでTwitter Card（アイキャッチ画像）を設定したときのメモ。



"/>
  <meta name="twitter:site" content="@budougumi0617"/>
  <meta name="twitter:domain" content="budougumi0617.github.io"/>
  <meta name="twitter:creator" content="@budougumi0617"/>



  

  
  <script type="text/javascript">
    (function(add, cla){window['UserHeatTag']=cla;window[cla]=window[cla]||function(){(window[cla].q=window[cla].q||[]).push(arguments)},window[cla].l=1*new Date();var ul=document.createElement('script');var tag = document.getElementsByTagName('script')[0];ul.async=1;ul.src=add;tag.parentNode.insertBefore(ul,tag);})('//uh.nakanohito.jp/uhj2/uh.js', '_uhtracker');_uhtracker({id:'uhUEw1Gd9C'});
  </script>
  
</head>
<body>


<header role="banner"><hgroup>
  
  <h1><a href="https://budougumi0617.github.io/">My External Storage</a></h1>
    <h2></h2>
</hgroup></header>


<nav role="navigation">
<fieldset class="mobile-nav">
  
  <select onchange="location = this.value;">
    <option value="">Navigate…</option>
      
        <option value="https://budougumi0617.github.io/">» Home</option>
      
        <option value="https://budougumi0617.github.io/2017/07/11/about-this-site/">» About</option>
      
        <option value="https://budougumi0617.github.io/post/">» Archives</option>
      

  </select>
</fieldset>


<ul class="main-navigation">
  
  
    
      <li><a href="https://budougumi0617.github.io/" title="Home">Home</a></li>
    
  
    
      <li><a href="https://budougumi0617.github.io/2017/07/11/about-this-site/" title="About"  target="_blank" >About</a></li>
    
  
    
      <li><a href="https://budougumi0617.github.io/post/" title="Archives"  target="_blank" >Archives</a></li>
    
  
</ul>


<ul class="subscription">
  
    
        <a href="https://budougumi0617.github.io/index.xml" target="_blank" type="application/rss+xml" title="RSS"><i class="fa fa-rss-square fa-lg"></i></a>
    
  

</ul>


</nav>


<div id="main">
  <div id="content">
    <div>
      <article class="hentry" role="article">

        
        

<header>
    <p class="meta">Jan 4, 2019
         - 5 minute read 
         - <a href="https://budougumi0617.github.io/2019/01/04/set-twitter-image-in-hugo-blog/#disqus_thread">Comments</a>

        
        
        
            - <a class="label" href="https://budougumi0617.github.io/categories/hugo/">hugo </a><a class="label" href="https://budougumi0617.github.io/categories/blog/">blog </a>
        
    </p>
    <h1 class="entry-title">
         Hugoのブログ記事にTwitter Card(アイキャッチ画像)を設定する 
    </h1>
</header>


        <div class="entry-content">
          
          
          
          
            <nav id="TableOfContents">
<ul>
<li><a href="#tl-dr">TL;DR</a></li>
<li><a href="#hugo-octopress-themesでtwitterカードの画像を設定する">Hugo-Octopress ThemesでTwitterカードの画像を設定する</a></li>
<li><a href="#custom-twitter-card-htmlを変更して-twitterimage-の指定方法を上書きする">custom_twitter_card.htmlを変更して<code>twitterImage</code>の指定方法を上書きする。</a></li>
<li><a href="#記事作成時にデフォルト設定として-twitterimage-を設定しておく">記事作成時にデフォルト設定として<code>twitterImage</code>を設定しておく</a></li>
<li><a href="#終わりに">終わりに</a></li>
<li><a href="#参考">参考</a></li>
</ul>
</nav>
          
          <p>HugoでTwitter Card（アイキャッチ画像）を設定したときのメモ。</p>

<p><img src="/2019/01/04-twitter-image.png" alt="card validator" /></p>

<p></p>

<p>なお利用しているHugoのバージョンは以下。</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hugo version
Hugo Static Site Generator v0.50/extended darwin/amd64 BuildDate: unknown</code></pre></div>
<p>Themesは以下を利用している。</p>

<ul>
<li>Hugo-Octopress

<ul>
<li><a href="https://github.com/parsiya/Hugo-Octopress">https://github.com/parsiya/Hugo-Octopress</a></li>
</ul></li>
</ul>

<h1 id="tl-dr">TL;DR</h1>

<ul>
<li>Hugo-Octopress ThemesでTwitterカードの画像(<code>twitterImage</code>)を設定する

<ul>
<li><a href="https://github.com/parsiya/Hugo-Octopress#twitter">https://github.com/parsiya/Hugo-Octopress#twitter</a></li>
</ul></li>
<li>Hugoのもろもろの設定はGoの<code>text/template</code>のお作法を知っておく必要がある

<ul>
<li><a href="https://golang.org/pkg/text/template/">https://golang.org/pkg/text/template/</a></li>
</ul></li>
<li>Hugoの環境変数（？）を使ってルートディレクトリ直下の画像を使うようにした。

<ul>
<li><code>&lt;meta name=&quot;twitter:image:src&quot; content=&quot;{{ print $.Site.BaseURL . }}&quot;/&gt;</code></li>
</ul></li>
<li><code>archetypes/post.md</code>を書いておけば既定のTwitter Cardのイメージとして設定しておける

<ul>
<li><a href="https://gohugo.io/content-management/archetypes/">https://gohugo.io/content-management/archetypes/</a></li>
</ul></li>
</ul>

<h1 id="hugo-octopress-themesでtwitterカードの画像を設定する">Hugo-Octopress ThemesでTwitterカードの画像を設定する</h1>

<p>Twitter CardとはTwitterにURLが貼られたとき、アイキャッチ画像やタイトルが展開されるように設定する機能のことだ。
Hugoは利用しているテーマごとに各設定の有効化方法が異なる。私のHugoはHugo-Octopressというテーマを使っているのでまずHugo-OctopressでどのようにTwitter Cardを有効化するのか確認する。</p>

<ul>
<li><a href="https://github.com/parsiya/Hugo-Octopress#twitter">https://github.com/parsiya/Hugo-Octopress#twitter</a></li>
</ul>

<p>まずはREADMEに書いてあるとおり、config.yamlでTwitter Cardを有効化する。</p>

<p><a href="https://github.com/budougumi0617/blog/blob/77576171a8f4ef593e092d7b42a977ad452fa3f3/config.toml#L65-L72">budougumi0617/blog/config.toml</a></p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">    <span style="color:#586e75"># Twitter card config</span>
    <span style="color:#586e75"># Enable with this.</span>
    twitterCardEnabled = <span style="color:#cb4b16">true</span>
    <span style="color:#586e75"># Don&#39;t include the @.</span>
    <span style="color:#586e75"># twitterCardSite =</span>
    twitterCardDomain = <span style="color:#2aa198">&#34;budougumi0617.github.io&#34;</span>
    <span style="color:#586e75"># Don&#39;t include the @.</span>
    twitterCardAuthor = <span style="color:#2aa198">&#34;budougumi0617&#34;</span></code></pre></div>
<p>次にTwitter Cardの画像イメージ(<code>twitterImage</code>)設定をする。READMEを確認すると、記事ごとに設定しないといけないらしい。</p>

<blockquote>
<p>After Twitter card is enabled, you can add summary images to your posts in front matter with twitterImage:
twitterImage: 02-fuzzer-crash.png</p>
</blockquote>

<p>また、<code>twitterImage</code>は「記事と相対的な場所」に置かないといけないらしい。</p>

<blockquote>
<p>Note: Image URL should be relative to the page, otherwise the final URL will not be correct. In short, image URL should be part of the page bundle. In this case, both index.md and 02-fuzzer-crash.png are in the same root directory. If the image is in a subdirectory of page bundle, it can be added like this:
twitterImage: images/02-fuzzer-crash.png</p>
</blockquote>

<p>私の場合、デフォルト用の画像を用意しておいて<code>twitterImage</code>を設定したい。なので「ルートディレクトリからの絶対パス」で画像を指定したいのでこの設定を変更する。</p>

<h1 id="custom-twitter-card-htmlを変更して-twitterimage-の指定方法を上書きする">custom_twitter_card.htmlを変更して<code>twitterImage</code>の指定方法を上書きする。</h1>

<ul>
<li><a href="https://gohugo.io/templates/partials/">https://gohugo.io/templates/partials/</a></li>
</ul>

<p>Hugoではカスタムした設定ファイルを置いておけばThemesの設定ファイルを上書きできる。
Twitter Cardの設定はcustom_twitter_card.htmlで設定できる。Hugo-OctopressでtwitterImageを指定している部分のコードは以下。</p>

<ul>
<li><a href="https://github.com/parsiya/Hugo-Octopress/blob/e62b793c61e75bae591e19af343f15941b955f1d/layouts/partials/custom_twitter_card.html">https://github.com/parsiya/Hugo-Octopress/layouts/partials/custom_twitter_card.html</a></li>
</ul>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">...
  {{ with .Params.twitterImage }}
  <span style="color:#586e75">&lt;!-- Twitter summary card with large image must be at least 280x150px --&gt;</span>
    &lt;<span style="color:#268bd2">meta</span> name<span style="color:#719e07">=</span><span style="color:#2aa198">&#34;twitter:card&#34;</span> content<span style="color:#719e07">=</span><span style="color:#2aa198">&#34;summary_large_image&#34;</span>/&gt;
    &lt;<span style="color:#268bd2">meta</span> name<span style="color:#719e07">=</span><span style="color:#2aa198">&#34;twitter:image:src&#34;</span> content<span style="color:#719e07">=</span><span style="color:#2aa198">&#34;{{ print $.Permalink . }}&#34;</span>/&gt;
  {{ else }}
    &lt;<span style="color:#268bd2">meta</span> name<span style="color:#719e07">=</span><span style="color:#2aa198">&#34;twitter:card&#34;</span> content<span style="color:#719e07">=</span><span style="color:#2aa198">&#34;summary&#34;</span>/&gt;
  {{ end }}
...</code></pre></div>
<p>この中の<code>{{ print $.Permalink . }}</code>を変更するので、まずcustom_twitter_card.htmlをコピーして設定上書き用のファイルを作成する。</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cp themes/Hugo-Octopress/layouts/partials/custom_twitter_card.html layouts/partials/</code></pre></div>
<p>以下の変数の説明から<code>Permalink</code>を確認すると、ページURLのことだとわかる。また、custom_twitter_card.htmlの記法はGoの<code>text/template</code>に則っている。</p>

<ul>
<li>Variables and Params

<ul>
<li><a href="https://gohugo.io/variables/">https://gohugo.io/variables/</a></li>
</ul></li>
<li>text/template/

<ul>
<li><a href="https://golang.org/pkg/text/template/">https://golang.org/pkg/text/template/</a></li>
</ul></li>
</ul>

<p>以上より<code>{{ print $.Permalink . }}</code>はページURLに<code>twitterImage</code>に設定されている文字列を連結(<code>fmt.Sprint</code>)しているとわかるのでブログのベースURLから文字列を連結するように変更する。<code>Variables and Params</code>から確認すると、<code>.Site.BaseURL</code>でブログのベースURLが参照できるので、上書き用のcustom_twitter_card.htmlを以下のように変更した。</p>

<ul>
<li><a href="https://github.com/budougumi0617/blog/blob/master/layouts/partials/custom_twitter_card.html">https://github.com/budougumi0617/blog/layouts/partials/custom_twitter_card.html</a></li>
</ul>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">...
  {{ with .Params.twitterImage }}
  <span style="color:#586e75">&lt;!-- Twitter summary card with large image must be at least 280x150px --&gt;</span>
    &lt;<span style="color:#268bd2">meta</span> name<span style="color:#719e07">=</span><span style="color:#2aa198">&#34;twitter:card&#34;</span> content<span style="color:#719e07">=</span><span style="color:#2aa198">&#34;summary_large_image&#34;</span>/&gt;
    &lt;<span style="color:#268bd2">meta</span> name<span style="color:#719e07">=</span><span style="color:#2aa198">&#34;twitter:image:src&#34;</span> content<span style="color:#719e07">=</span><span style="color:#2aa198">&#34;{{ print $.Site.BaseURL . }}&#34;</span>/&gt;
  {{ else }}
    &lt;<span style="color:#268bd2">meta</span> name<span style="color:#719e07">=</span><span style="color:#2aa198">&#34;twitter:card&#34;</span> content<span style="color:#719e07">=</span><span style="color:#2aa198">&#34;summary&#34;</span>/&gt;
  {{ end }}
...</code></pre></div>
<p>あとは記事に<code>twitterImage</code>を設定して<code>static</code>ディレクトリ以下に<code>twitterImage</code>用の画像を配置しておく。</p>

<ul>
<li><a href="https://github.com/budougumi0617/blog/blob/master/content/post/2018/12/27/retrospective-2018.md">https://github.com/budougumi0617/blog/blob/master/content/post/2018/12/27/retrospective-2018.md</a></li>
<li><a href="https://github.com/budougumi0617/blog/tree/master/static">https://github.com/budougumi0617/blog/tree/master/static</a></li>
</ul>

<p><code>hugo server</code>コマンドでエラーが出ないか動作確認したあと、Web上のデータを更新する。Twitter Cardの確認には以下のサービスを利用することができる。</p>

<ul>
<li>Card validator

<ul>
<li><a href="https://cards-dev.twitter.com/validator">https://cards-dev.twitter.com/validator</a></li>
</ul></li>
</ul>

<p>上記に<code>twitterImage</code>を設定した記事のURLを入力し、きちんと<code>twitterImage</code>が展開されることを確認する。</p>

<p><img src="/2019/01/04-twitter-image.png" alt="card validator" /></p>

<h1 id="記事作成時にデフォルト設定として-twitterimage-を設定しておく">記事作成時にデフォルト設定として<code>twitterImage</code>を設定しておく</h1>

<p>Hugoはarchetypes/post.mdを作っておけば<code>hugo new</code>コマンドで記事を新規作成したときのデフォルトデータを設定しておくことができる。archetypes/post.mdに以下を記述しておけばよい。</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-md" data-lang="md">+++
...
author = &#34;budougumi0617&#34;
twitterImage = &#34;twittercard.png&#34;
+++</code></pre></div>
<h1 id="終わりに">終わりに</h1>

<p>実は以前にもTwitterCardの設定をしようと思っていたのだが挙動がよくわからず失敗していた。
その時点ではそもそもテーマに含まれていたcustom_twitter_card.htmlの記述が間違っていたので失敗していたらしい。久しぶりに再調査したら以下のコミットがされており、今回の変更方法にも気づくことができた。</p>

<ul>
<li><a href="https://github.com/parsiya/Hugo-Octopress/commit/3462bf5e01899ec63d02525bb11ee74f286913c2#diff-2637780f50b837ee6eb9c442beb1076b">https://github.com/parsiya/Hugo-Octopress/commit/3462bf5e01899ec63d02525bb11ee74f286913c2#diff-2637780f50b837ee6eb9c442beb1076b</a></li>
</ul>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">   {{ with .Params.twitterImage }}
   &lt;!-- Twitter summary card with large image must be at least 280x150px --&gt;
     &lt;meta name=&#34;twitter:card&#34; content=&#34;summary_large_image&#34;/&gt;
<span style="color:#dc322f">-    &lt;meta name=&#34;twitter:image:src&#34; content=&#34;{{ index . 0 | absURL }}&#34;/&gt;
</span><span style="color:#dc322f"></span><span style="color:#719e07">+    &lt;meta name=&#34;twitter:image:src&#34; content=&#34;{{ print $.Permalink . }}&#34;/&gt;
</span><span style="color:#719e07"></span>   {{ else }}
     &lt;meta name=&#34;twitter:card&#34; content=&#34;summary&#34;/&gt;
   {{ end }}
</code></pre></div>
<p>また、Card validatorというのがあるのを初めて知った。しばらくはこれでどうTwitter Cardが見えるのか投稿後確認しておく。</p>

<h1 id="参考">参考</h1>

<ul>
<li>Hugo-Octopress

<ul>
<li><a href="https://github.com/parsiya/Hugo-Octopress">https://github.com/parsiya/Hugo-Octopress</a></li>
</ul></li>
<li>Partial Templates | Hugo

<ul>
<li><a href="https://gohugo.io/templates/partials/">https://gohugo.io/templates/partials/</a></li>
</ul></li>
<li>Variables and Params | Hugo

<ul>
<li><a href="https://gohugo.io/variables/">https://gohugo.io/variables/</a></li>
</ul></li>
<li>text/template package

<ul>
<li><a href="https://golang.org/pkg/text/template/">https://golang.org/pkg/text/template/</a></li>
</ul></li>
<li>Card validator

<ul>
<li><a href="https://cards-dev.twitter.com/validator">https://cards-dev.twitter.com/validator</a></li>
</ul></li>
</ul>
        </div>
        

<footer>
  <p class="meta">
    <span class="byline author vcard">Posted by <span class="fn"></span></span>
    
    <time>Jan 4, 2019</time>
    
      <span class="categories">
        Tags:
        
          <a class="category" href="https://budougumi0617.github.io/tags/hugo">hugo</a>  <a class="category" href="https://budougumi0617.github.io/tags/twitter">twitter</a>  <a class="category" href="https://budougumi0617.github.io/tags/blog">blog</a>  
    
    </span>
  </p>

  
  

  

  <p class="meta">
    
        <a class="basic-alignment left" href="https://budougumi0617.github.io/2018/12/27/retrospective-2018/" title="2018年振り返り">2018年振り返り</a>
    

    
      <a class="basic-alignment right" href="https://budougumi0617.github.io/2019/01/05/set-ogp-in-hugo-blog/" title="HugoでOGP(Facebook用のアイキャッチ画像)を設定する #hugo">HugoでOGP(Facebook用のアイキャッチ画像)を設定する #hugo</a>
    
  </p>
  
    
      <div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'http-budougumi0617-github-io';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    
  
</footer>

      </article>
    </div>
    

<aside class="sidebar thirds">
  <section class="first odd">

    

    <p>
      
    </p>
  </section>



  
  <ul class="sidebar-nav">
    <li class="sidebar-nav-item">
      <a target="_blank" href="https://github.com/budougumi0617" title="https://github.com/budougumi0617"><i class="fa fa-github fa-3x"></i></a>
      
      
      <a target="_blank" href="https://twitter.com/budougumi0617" title="https://twitter.com/budougumi0617"><i class="fa fa-twitter fa-3x"></i></a>
      
         
      
      <a target="_blank" href="https://www.linkedin.com/in/budougumi0617/" title="https://www.linkedin.com/in/budougumi0617/"><i class="fa fa-linkedin fa-3x"></i></a>
      
      
      
      
      
      

    
    
    </li>
  </ul>

  

  
    
      <section class="odd">
        
          <h1>Archives</h1>
        
        
          <li>
            <a href="https://budougumi0617.github.io/categories/" title="Categories" >Categories</a>
          </li>
        
          <li>
            <a href="https://budougumi0617.github.io/tags/" title="Tags" >Tags</a>
          </li>
        
      </section>
    
  

  
  
  
    
      <section class="even">
        <h1>Recent Posts</h1>
        <ul id="recent_posts">
          
          
            
              <li class="post">
                <a href="/2019/01/05/set-ogp-in-hugo-blog/">HugoでOGP(Facebook用のアイキャッチ画像)を設定する #hugo</a>
              </li>
            
          
            
              <li class="post">
                <a href="/2019/01/04/set-twitter-image-in-hugo-blog/">Hugoのブログ記事にTwitter Card(アイキャッチ画像)を設定する</a>
              </li>
            
          
            
              <li class="post">
                <a href="/2018/12/27/retrospective-2018/">2018年振り返り</a>
              </li>
            
          
            
              <li class="post">
                <a href="/2018/12/19/report-golangtokyo-20/">golang.tokyo #20 忘年LT大会！！ 参加メモ #golangtokyo</a>
              </li>
            
          
            
              <li class="post">
                <a href="/2018/12/15/retrospective-on-github/">2018年振り返り(GitHub編)</a>
              </li>
            
          
        </ul>
      </section>
    
  
</aside>

  </div>
</div>

<footer role="contentinfo">
  <p>Copyright &copy; 2019  - <a href="https://budougumi0617.github.io/license/">License</a> -
  <span class="credit">Powered by <a target="_blank" href="https://gohugo.io">Hugo</a> and <a target="_blank" href="https://github.com/parsiya/hugo-octopress/">Hugo-Octopress</a> theme.
</p>

</footer>






<script>
  var _gaq=[['_setAccount','UA-43042615-4'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>

